import{l as Z,v as f}from"./@vue.runtime-dom-99571815.js";import{i as ee,s as K,m as te}from"./index-bb32f0e8.js";import{V as oe,l as T,d as se,o as ie}from"./@element-plus.icons-vue-73c86597.js";import{a as ne}from"./@vueuse.core-c33523a6.js";import{j as N,o as z,c as j,a as e,a7 as ae,q as le,d as de,X as v,b as s,K as m,O as h,L as g,F as re,N as D,J as L,as as ce,ar as me}from"./@vue.runtime-core-561bebe5.js";import{O as E}from"./@vue.shared-40d3234d.js";import{_ as G}from"./_plugin-vue_export-helper-c27b6911.js";import{u as ue}from"./menu-882dd0f5.js";import{l as pe}from"./socket.io-client-c7af6a83.js";import"./store-acb3382e.js";import{u as A}from"./index-0aca6396.js";import{c as _e,a as w,b as X}from"./element-plus-ca11a4ea.js";import{d as fe,x as ve}from"./lodash-es-74a5df03.js";import{j as S,u}from"./@vue.reactivity-97074417.js";import"./axios-f6771985.js";import"./nprogress-5ff42f71.js";import"./chardet-cfd7d38a.js";import"./pinia-d82d1bdc.js";import"./vue-demi-71ba0ef2.js";import"./monaco-editor-f913c445.js";import"./vue-echarts-0ed26588.js";import"./resize-detector-a5205554.js";import"./echarts-eea5b079.js";import"./tslib-54e39b60.js";import"./zrender-ecf5ed03.js";import"./vue-router-c769f697.js";import"./mitt-b509fb6d.js";import"./mockjs-597bdf6e.js";import"./vue-052dfabe.js";import"./@popperjs.core-c75af06c.js";import"./@ctrl.tinycolor-f8748455.js";import"./dayjs-e0a79e34.js";import"./async-validator-8a4f889d.js";import"./memoize-one-297ddbcb.js";import"./escape-html-f47942fe.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui.dom-4390772d.js";import"./@floating-ui.core-1d013f45.js";import"./@floating-ui.utils-1e4a7d10.js";import"./@vueuse.shared-b7ebfaaa.js";import"./engine.io-client-0a8b97a6.js";import"./engine.io-parser-b13552ae.js";import"./@socket.io.component-emitter-3e1df240.js";import"./socket.io-parser-bc267b40.js";function he(){const{route:r,router:p}=A();let l;function V(c){l||(l=pe("https://service.cool-js.com/code",{transports:["websocket"]}),l&&(l.on("connect",()=>{l==null||l.on("data",x=>{var b,k;if(x.isEnd){if(r.path!="/magic/ai-code"){const $=_e({title:"提示",message:"Ai自动生成代码完成，点击查看",duration:0,onClick(){p.push("/magic/ai-code"),$.close()}})}(b=c.onComplete)==null||b.call(c)}else try{(k=c==null?void 0:c.onMessage)==null||k.call(c,x.content)}catch{}})}),l.on("disconnect",x=>{})))}function C(c){l==null||l.emit("instruct",c)}return{connect:V,send:C}}function ge(){const{mitt:r}=A();let p;function l(){V(),p=setInterval(()=>{r.emit("view.scrollTo",{top:Math.random()+1e4})},100)}function V(){p&&clearInterval(p)}return{start:l,stop:V}}const ye={class:"text-stage"},Ve={class:"wrapper"},Ce=ae('<div class="slash" data-v-a0f669c6></div><div class="sides" data-v-a0f669c6><div class="side" data-v-a0f669c6></div><div class="side" data-v-a0f669c6></div><div class="side" data-v-a0f669c6></div><div class="side" data-v-a0f669c6></div></div>',2),xe={class:"text"},be={class:"text--backing"},ke={class:"text--left"},we={class:"inner"},ze={class:"text--right"},$e={class:"inner"},Se=N({name:"undefined"}),Ee=N({...Se,props:{fontSize:{type:String,default:"30px"},color:{type:String,default:"#000000"},modelValue:String},setup(r){return Z(p=>({ae47e94a:r.fontSize})),(p,l)=>(z(),j("div",ye,[e("div",Ve,[Ce,e("div",xe,[e("div",be,E(r.modelValue),1),e("div",ke,[e("div",we,E(r.modelValue),1)]),e("div",ze,[e("div",$e,E(r.modelValue),1)])])])]))}});const Ne=G(Ee,[["__scopeId","data-v-a0f669c6"]]),y=r=>(ce("data-v-260e0a14"),r=r(),me(),r),Ie={class:"ai-code"},Ue={class:"container"},Me={class:"head"},Fe={class:"form"},Be=y(()=>e("div",{class:"label required"},"CRUD",-1)),Te={class:"row"},De=y(()=>e("div",{class:"label"},"其他你想做的事？",-1)),je={class:"btns"},Ae=y(()=>e("div",{class:"tips"},"如遇见 “代码缺失”、“请求超时”，请尝试「刷新」吧",-1)),qe={class:"codes"},Oe={class:"item is-entity"},Re={class:"label"},Je={class:"name"},Ke=y(()=>e("span",null,"Entity（实体类）",-1)),Le={class:"item is-controller"},Xe={class:"label"},Ge={class:"name"},He=y(()=>e("span",null,"Controller（控制层）",-1)),Pe={class:"item is-vue"},Qe={class:"label"},We={class:"name"},Ye=y(()=>e("span",null,"Vue（页面）",-1)),Ze={class:"op"},et=y(()=>e("div",{class:"bottom"},null,-1)),tt=N({name:"magic-ai-code"}),ot=N({...tt,setup(r){const{service:p,mitt:l,refs:V,setRefs:C}=A(),{copy:c}=ne(),x=ue(),b=he(),k=ge(),$=ee.useForm(),I=S({options:{fontSize:16}}),d=S(K.get("ai-create.form")||{name:"收货地址",module:"user",other:"",columns:"用户ID、联系人、手机号、省市区、地址、是否默认"}),o=S({disabled:!1,coding:"",data:{router:"",prefix:"",path:"",module:"",fileName:"",className:"",other:"",columns:[],api:[]},api:[{path:"/add",summary:"新增"},{path:"/info",summary:"单个信息"},{path:"/update",summary:"修改"},{path:"/delete",summary:"删除"},{path:"/page",summary:"分页查询"},{path:"/list",summary:"列表查询"}]}),i=S({entity:"",controller:"",vue:""});function q(n="entity",t){o.disabled=!0,o.coding=n,b.send({...t,type:n}),k.start()}function O(){o.disabled=!1,o.coding="",k.stop()}function R(){O(),i.entity="",i.controller="",i.vue=""}function H(){if(!d.module)return w.warning("请选择模块");if(!d.name)return w.warning("請填寫实体名称");if(ve(d.columns))return w.warning("請填寫字段");function n(){R(),q("entity",{...d,columns:d.columns.split("、")})}i.entity?X.confirm("此操作将重新生成代码，是否继续？","提示",{type:"warning"}).then(()=>{n()}).catch(()=>null):n()}function U(n){c(i[n]),w.success("复制成功")}function P(){return w.error("只有在开发环境下才有效")}const J=fe(n=>{async function t(){i.entity&&(i.vue=x.createVue(o.data),O(),setTimeout(()=>{l.emit("view.scrollTo",{el:".codes .is-vue"}),V.codeVue.formatCode()},300))}n?t():X.confirm("此操作将会重新生成vue代码，是否继续？","提示",{type:"warning"}).then(()=>{t()}).catch(()=>null)},300);return le(()=>d,n=>{K.set("ai-create.form",n)}),de(()=>{b.connect({onMessage(n){i[o.coding]=n.replace(/```typescript\n/g,"").replace(/```/g,"")},onComplete(){o.coding=="entity"?p.base.sys.menu.parse({entity:i.entity,module:d.module}).then(n=>{o.data={...d,...n,router:n.path.replace("/admin",""),prefix:n.path,api:o.api},q("controller",o.data)}):o.coding=="controller"&&J(!0)}})}),(n,t)=>{const Q=v("cl-select"),M=v("el-input"),W=v("el-form"),_=v("el-button"),F=v("el-icon"),B=v("cl-editor"),Y=v("cl-form");return z(),j("div",Ie,[e("div",Ue,[e("div",Me,[s(Ne,{"model-value":"Cool Ai 极速编码"})]),e("div",Fe,[s(W,{disabled:o.disabled},{default:m(()=>[Be,e("div",Te,[s(Q,{class:"module",placeholder:"请选择模块",size:"large",modelValue:d.module,"onUpdate:modelValue":t[0]||(t[0]=a=>d.module=a),options:u(te).dirs,"label-key":"name","value-key":"name","allow-create":""},null,8,["modelValue","options"]),s(M,{class:"name",modelValue:d.name,"onUpdate:modelValue":t[1]||(t[1]=a=>d.name=a),placeholder:"实体名称，如：收货地址"},null,8,["modelValue"]),s(M,{class:"columns",size:"large",modelValue:d.columns,"onUpdate:modelValue":t[2]||(t[2]=a=>d.columns=a),placeholder:"請填寫字段，如：姓名、年龄、状态"},null,8,["modelValue"])]),De,s(M,{type:"textarea",modelValue:d.other,"onUpdate:modelValue":t[3]||(t[3]=a=>d.other=a),rows:5,placeholder:"如：分页查询时姓名、手机号字段设置成可模糊搜索"},null,8,["modelValue"])]),_:1},8,["disabled"])]),e("div",je,[s(_,{round:"",size:"large",type:"primary",icon:u(oe),disabled:o.disabled,loading:o.disabled,onClick:H},{default:m(()=>[h(E(o.disabled?"思考中":i.entity.length?"重新生成":"下一步"),1)]),_:1},8,["icon","disabled","loading"])]),Ae,e("div",qe,[g(e("div",Oe,[e("div",Re,[e("div",Je,[Ke,g(s(F,{class:"is-loading"},{default:m(()=>[s(u(T))]),_:1},512),[[f,o.coding=="entity"]])]),o.disabled?D("",!0):(z(),j(re,{key:0},[s(_,{round:"",size:"small",onClick:t[4]||(t[4]=a=>U("entity"))},{default:m(()=>[h("Copy")]),_:1}),s(_,{round:"",type:"success",size:"small",onClick:t[5]||(t[5]=a=>u(J)())},{default:m(()=>[h(" 生成Vue代码 ")]),_:1})],64))]),s(B,{name:"cl-editor-monaco",ref:u(C)("codeEntity"),options:I.options,height:"auto",autofocus:"",autosize:"",language:"typescript",modelValue:i.entity,"onUpdate:modelValue":t[6]||(t[6]=a=>i.entity=a)},null,8,["options","modelValue"])],512),[[f,i.entity]]),g(e("div",Le,[e("div",Xe,[e("div",Ge,[He,g(s(F,{class:"is-loading"},{default:m(()=>[s(u(T))]),_:1},512),[[f,o.coding=="controller"]])]),o.disabled?D("",!0):(z(),L(_,{key:0,round:"",size:"small",onClick:t[7]||(t[7]=a=>U("controller"))},{default:m(()=>[h("Copy")]),_:1}))]),s(B,{name:"cl-editor-monaco",ref:u(C)("codeController"),options:I.options,height:"auto",autosize:"",language:"typescript",modelValue:i.controller,"onUpdate:modelValue":t[8]||(t[8]=a=>i.controller=a)},null,8,["options","modelValue"])],512),[[f,i.controller]]),g(e("div",Pe,[e("div",Qe,[e("div",We,[Ye,g(s(F,{class:"is-loading"},{default:m(()=>[s(u(T))]),_:1},512),[[f,o.coding=="vue"]])]),o.disabled?D("",!0):(z(),L(_,{key:0,round:"",size:"small",onClick:t[9]||(t[9]=a=>U("vue"))},{default:m(()=>[h("Copy")]),_:1}))]),s(B,{name:"cl-editor-monaco",ref:u(C)("codeVue"),options:I.options,height:"auto",autosize:"",language:"html",modelValue:i.vue,"onUpdate:modelValue":t[10]||(t[10]=a=>i.vue=a)},null,8,["options","modelValue"])],512),[[f,i.vue]])]),g(e("div",Ze,[s(_,{icon:u(se),round:"",size:"large",onClick:R},{default:m(()=>[h(" 取消 ")]),_:1},8,["icon"]),s(_,{icon:u(ie),round:"",size:"large",type:"success",onClick:P},{default:m(()=>[h(" 创建文件 ")]),_:1},8,["icon"])],512),[[f,!o.disabled&&i.entity.length]]),et]),s(Y,{ref_key:"Form",ref:$},null,512)])}}});const Gt=G(ot,[["__scopeId","data-v-260e0a14"]]);export{Gt as default};
