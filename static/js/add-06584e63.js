import{o as D}from"./vue-router-c769f697.js";import"./index-7178fe38.js";import"./store-acb3382e.js";import{u as F}from"./index-819678c4.js";import{a as w}from"./element-plus-ca11a4ea.js";import{j as S,d as j,e as h,X as a,o as T,c as z,a as d,b as o,K as n,O as H,as as L,ar as A}from"./@vue.runtime-core-561bebe5.js";import{r as C,j as I}from"./@vue.reactivity-97074417.js";import{_ as $}from"./_plugin-vue_export-helper-c27b6911.js";import"./@vue.runtime-dom-99571815.js";import"./@vue.shared-40d3234d.js";import"./axios-f6771985.js";import"./nprogress-5ff42f71.js";import"./chardet-cfd7d38a.js";import"./pinia-d82d1bdc.js";import"./vue-demi-71ba0ef2.js";import"./monaco-editor-f913c445.js";import"./vue-echarts-0ed26588.js";import"./resize-detector-a5205554.js";import"./echarts-eea5b079.js";import"./tslib-54e39b60.js";import"./zrender-ecf5ed03.js";import"./lodash-es-74a5df03.js";import"./@vueuse.core-c33523a6.js";import"./@vueuse.shared-b7ebfaaa.js";import"./mitt-b509fb6d.js";import"./mockjs-597bdf6e.js";import"./vue-052dfabe.js";import"./@element-plus.icons-vue-73c86597.js";import"./@popperjs.core-c75af06c.js";import"./@ctrl.tinycolor-f8748455.js";import"./dayjs-e0a79e34.js";import"./async-validator-8a4f889d.js";import"./memoize-one-297ddbcb.js";import"./escape-html-f47942fe.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui.dom-4390772d.js";import"./@floating-ui.core-1d013f45.js";import"./@floating-ui.utils-1e4a7d10.js";const N=S({name:"project-add",setup(){const{refs:e,setRefs:l,service:v,route:y,router:b}=F(),m=C(!1);j(()=>window.addEventListener("keypress",p)),h(async()=>window.removeEventListener("keypress",p));const p=()=>m.value=!0;D(()=>{if(!m.value)return;if(!window.confirm("尚未儲存修改內容，確定要離開嗎?"))return!1});const c=r=>{m.value&&(r.preventDefault(),r.returnValue=!0)};j(()=>window.addEventListener("beforeunload",c)),h(()=>window.removeEventListener("beforeunload",c));const i=I({project:{name:null,slug:null,video:null,cover:null,publish:!0,publishTime:new Date},info:{en:{locale:"en",title:null,intro:null,seoTitle:null,seoDescription:null},"zh-Hant":{locale:"zh-Hant",title:null,intro:null,seoTitle:null,seoDescription:null}}}),s=C("zh-Hant");return{service:v,refs:e,setRefs:l,onSubmit:async()=>{i.project.cover&&(i.project.cover=i.project.cover[0]),i.project.video&&(i.project.video=i.project.video[0]),await v.project.index.add(i).then(r=>{w.success("成功"),m.value=!1,b.go(-1)}).catch(r=>{w.error(r)})},form:i,locale:s}}});const f=e=>(L("data-v-d9a9bb47"),e=e(),A(),e),M={class:"add"},O={class:"add-header"},R=f(()=>d("h4",null,"新增作品",-1)),K={class:"grid-content"},P={class:"grid-content"},X=f(()=>d("h3",null,"Project",-1)),q={class:"grid-content"},G=f(()=>d("h3",null,"Slug",-1)),J={class:"grid-content"},Q=f(()=>d("h3",null,"SEO",-1)),W={class:"grid-content"},Y={class:"grid-content"},Z=f(()=>d("h3",null,"封面 & 影片",-1));function x(e,l,v,y,b,m){const p=a("el-option"),c=a("el-select"),i=a("el-button"),s=a("el-input"),u=a("el-form-item"),r=a("el-form"),_=a("el-divider"),E=a("cl-editor-wang"),V=a("el-col"),U=a("el-switch"),k=a("el-date-picker"),g=a("cl-upload"),B=a("el-row");return T(),z("div",M,[d("div",O,[R,o(c,{style:{width:"120px"},modelValue:e.locale,"onUpdate:modelValue":l[0]||(l[0]=t=>e.locale=t),placeholder:"選擇語系"},{default:n(()=>[o(p,{label:"中文",value:"zh-Hant"}),o(p,{label:"English",value:"en"})]),_:1},8,["modelValue"]),o(i,{type:"primary",onClick:e.onSubmit},{default:n(()=>[H("送出")]),_:1},8,["onClick"])]),o(B,{class:"add-body",justify:"end",gutter:12},{default:n(()=>[o(V,{style:{"margin-bottom":"20px"},lg:18},{default:n(()=>[d("div",K,[o(r,{model:e.form},{default:n(()=>[o(u,null,{default:n(()=>[o(s,{size:"large",modelValue:e.form.project.name,"onUpdate:modelValue":l[1]||(l[1]=t=>e.form.project.name=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),d("div",P,[X,o(_),o(r,{model:e.form},{default:n(()=>[o(u,{label:"標題"},{default:n(()=>[o(s,{size:"large",modelValue:e.form.info[e.locale].title,"onUpdate:modelValue":l[2]||(l[2]=t=>e.form.info[e.locale].title=t)},null,8,["modelValue"])]),_:1}),o(u,{label:"簡介"},{default:n(()=>[o(E,{modelValue:e.form.info[e.locale].intro,"onUpdate:modelValue":l[3]||(l[3]=t=>e.form.info[e.locale].intro=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),d("div",q,[G,o(_),o(r,{model:e.form},{default:n(()=>[o(u,null,{default:n(()=>[o(s,{modelValue:e.form.project.slug,"onUpdate:modelValue":l[4]||(l[4]=t=>e.form.project.slug=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),d("div",J,[Q,o(_),o(r,{model:e.form},{default:n(()=>[o(u,{label:"標題"},{default:n(()=>[o(s,{size:"large",modelValue:e.form.info[e.locale].seoTitle,"onUpdate:modelValue":l[5]||(l[5]=t=>e.form.info[e.locale].seoTitle=t)},null,8,["modelValue"])]),_:1}),o(u,{label:"簡介"},{default:n(()=>[o(s,{type:"textarea",rows:"5",modelValue:e.form.info[e.locale].seoDescription,"onUpdate:modelValue":l[6]||(l[6]=t=>e.form.info[e.locale].seoDescription=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1}),o(V,{lg:6},{default:n(()=>[d("div",W,[o(r,{model:e.form,"label-position":"left","label-width":"75"},{default:n(()=>[o(u,{label:"已發佈"},{default:n(()=>[o(U,{modelValue:e.form.project.publish,"onUpdate:modelValue":l[7]||(l[7]=t=>e.form.project.publish=t),style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"}},null,8,["modelValue"])]),_:1}),o(u,{label:"發布時間"},{default:n(()=>[o(k,{modelValue:e.form.project.publishTime,"onUpdate:modelValue":l[8]||(l[8]=t=>e.form.project.publishTime=t),type:"datetime",placeholder:"輸入發布時間"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),d("div",Y,[Z,o(_),o(r,{model:e.form},{default:n(()=>[o(u,{label:"封面"},{default:n(()=>[o(g,{draggable:"",style:{background:"#fff"},"is-space":"",accept:"image/*",modelValue:e.form.project.cover,"onUpdate:modelValue":l[9]||(l[9]=t=>e.form.project.cover=t)},null,8,["modelValue"])]),_:1}),o(u,{label:"影片"},{default:n(()=>[o(g,{type:"file",style:{background:"#fff"},"is-space":"",accept:"video/*",modelValue:e.form.project.video,"onUpdate:modelValue":l[10]||(l[10]=t=>e.form.project.video=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1})]),_:1})])}const $e=$(N,[["render",x],["__scopeId","data-v-d9a9bb47"]]);export{$e as default};
